{"ast":null,"code":"import _defineProperty from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useRef}from'react';import FusePageSimple from'@fuse/core/FusePageSimple';import{useSnackbar}from'notistack';import{useTranslation}from'react-i18next';import{useSelector}from'react-redux';import{useEventCallback}from'rxjs-hooks';import{tap,concatMap}from'rxjs/operators';import{of}from'rxjs';import _ from'@lodash';import{styled}from'@mui/material/styles';import{Hidden,Button,Icon,Typography,CircularProgress}from'@mui/material';import{makeStyles}from'@mui/styles';import*as FileSaver from'file-saver';import TravelContext from'./travel-context/TravelContext';import useGeolocation from'./tools/useGeolocation/GeoLocation';import NavbarToggleButton from'../../fuse-layouts/shared-components/NavbarToggleButton';import TableExecution from'./contentExecution/TableExecution';import{Dicoin,Trip,RecordGenerationRules,TransmissionConfig,EVENT_TYPES}from'./tools/dicoin-engine';import DialogCreateExecution from'./dialogs/DialogCreateExecution';import DialogAddNote from'./dialogs/DialogAddNote';import DialogFinalize from'./dialogs/DialogFinalize';import DialogStatistics from'./dialogs/DialogStatistics';import DialogRecordDetail from'./dialogs/DialogRecordDetail';import DialogDownload from'./dialogs/DialogDownload';import DialogConfirm from'./dialogs/DialogConfirm';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Root=styled(FusePageSimple)({'& .FusePageSimple-header':{height:'auto',minHeight:'auto'},'& .FusePageSimple-toolbar':{},'& .FusePageSimple-content':{},'& .FusePageSimple-sidebarHeader':{},'& .FusePageSimple-sidebarContent':{}});var useStyles=makeStyles({TransformRotate:{transform:'rotate(-90deg)'},btnHeaderWhite:{padding:'6px',background:'white',minWidth:'auto',color:'#202937'},btnHeader:{padding:'6px',minWidth:'auto',color:'white'},contenTable:{height:'calc(100vh - 93px)',// height: 'calc(100vh - 150px)',\nbackground:'white','& > div':{display:'flex',flexWrap:'wrap',height:'100%',placeContent:'start','& > div:nth-child(2)':{transition:'all 0.5s ease'}}},noHover:{'&:hover':{backgroundColor:'white'}},btnSilver:{background:'#808080'}});var rowHeight=29;function TravelsPage(props){var _useTranslation=useTranslation('travelsPage'),t=_useTranslation.t;var _useState=useState(window.innerHeight-210),_useState2=_slicedToArray(_useState,2),availableHeight=_useState2[0],setAvailableHeight=_useState2[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var configFuse=useSelector(function(_ref){var fuse=_ref.fuse;return fuse.settings.current.layout.config;});var navbar=useSelector(function(_ref2){var fuse=_ref2.fuse;return fuse.navbar;});var classes=useStyles();var _useState3=useState({onLine:false}),_useState4=_slicedToArray(_useState3,2),dataDialogNewExecution=_useState4[0],setDataDialogNewExecution=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),initialized=_useState6[0],setInitialized=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),open=_useState8[0],setOpen=_useState8[1];var _useEventCallback=useEventCallback(function(event$){return event$.pipe(concatMap(function(s){return of(s).pipe(tap(function(_ref3){var applierSource=_ref3.applierSource,action=_ref3.action;console.log('applierSource',applierSource);action();}));}));}),_useEventCallback2=_slicedToArray(_useEventCallback,2),applierCallBack=_useEventCallback2[0],applier=_useEventCallback2[1];var handleClickOpen=function handleClickOpen(){setOpen(true);};var handleClose=function handleClose(){setOpen(false);};// #region cardDragAnimateBtn\nvar _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),openCard=_useState10[0],setOpenCard=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),displayBtnDisabled=_useState12[0],setDisplayBtnDisabled=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),progressLoading=_useState14[0],setProgressLoading=_useState14[1];var cards=['top','bottom'];function hadleOpenBtnDrag(){setOpenCard(false);setProgressLoading(true);setAvailableHeight(window.innerHeight-536);setTimeout(function(){setOpenCard(true);setDisplayBtnDisabled(false);},500);}function hadleCloseBtnDrag(){setOpenCard(false);}useEffect(function(){if(displayBtnDisabled){var btn=document.getElementById('myBtnHeaderCards');if(btn){btn.blur();}}},[displayBtnDisabled]);//  #endregion\n//  #region device orientation\nvar _useState15=useState('portrait'),_useState16=_slicedToArray(_useState15,2),orientation=_useState16[0],setOrientation=_useState16[1];var _useState17=useState(true),_useState18=_slicedToArray(_useState17,2),isMobile=_useState18[0],setIsMobile=_useState18[1];//  #endregion\n//  #region keyboard detected\nvar _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),keyboardDetected=_useState20[0],setKeyboardDetected=_useState20[1];var _useState21=useState(null),_useState22=_slicedToArray(_useState21,2),focusInput=_useState22[0],setFocusInput=_useState22[1];function onKeyboardOnOff(isOpen){// Write down your handling code\nif(isOpen){setKeyboardDetected(true);}else{setKeyboardDetected(false);}}var originalPotion=false;window.onload=function(){if(originalPotion===false)originalPotion=window.innerWidth+window.innerHeight;};/**\n   * Determine the mobile operating system.\n   * This function returns one of 'iOS', 'Android', 'Windows Phone', or 'unknown'.\n   *\n   * @returns {String}\n   */function getMobileOperatingSystem(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;// Windows Phone must come first because its UA also contains \"Android\"\nif(/windows phone/i.test(userAgent)){return'winphone';}if(/android/i.test(userAgent)){return'android';}// iOS detection from: http://stackoverflow.com/a/9039885/177710\nif(/iPad|iPhone|iPod/.test(userAgent)&&!window.MSStream){return'ios';}return'';}function applyAfterResize(){if(getMobileOperatingSystem()!=='ios'){if(originalPotion!==false){var wasWithKeyboard=document.querySelector('body').classList.contains('view-withKeyboard');var nowWithKeyboard=false;var diff=Math.abs(originalPotion-(document.querySelector(window).width()+document.querySelector(window).height()));if(diff>100)nowWithKeyboard=true;document.querySelector('body').classList.toggle('view-withKeyboard',nowWithKeyboard);if(wasWithKeyboard!==nowWithKeyboard){onKeyboardOnOff(nowWithKeyboard);}}}}var itemsEvents=['select','textarea','input'];itemsEvents.forEach(function(item){var items=document.getElementsByTagName(\"\".concat(item));Array.from(items).forEach(function(i,index){if(i.name){document.querySelector(\"\".concat(item,\"[name=\").concat(i.id,\"]\")).addEventListener('focus',function(e){var nowWithKeyboard=e.type==='focus';document.querySelector('body').classList.toggle('view-withKeyboard',nowWithKeyboard);onKeyboardOnOff(nowWithKeyboard);var node=document.getElementById(\"\".concat(i.id));node.select();setFocusInput(i.id);});document.querySelector(\"\".concat(item,\"[name=\").concat(i.id,\"]\")).addEventListener('blur',function(e){var nowWithKeyboard=e.type==='focus';document.querySelector('body').classList.toggle('view-withKeyboard',nowWithKeyboard);onKeyboardOnOff(nowWithKeyboard);setFocusInput(null);});}});});document.querySelector('html').addEventListener('resize',function(){if(!open){applyAfterResize();}});document.querySelector('html').addEventListener('orientationchange',function(){if(!open){applyAfterResize();}});//  #endregion\n//  #region time btns\nvar period=250;var _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),timeSecondsTop=_useState24[0],setTimeSecondsTop=_useState24[1];var _useState25=useState(0),_useState26=_slicedToArray(_useState25,2),timeSecondsBot=_useState26[0],setTimeSecondsBot=_useState26[1];var timeTop=useRef();var timeBot=useRef();useEffect(function(){var topFocus=(focusInput||'').match('top');if(timeSecondsTop>=0&&openCard){var value=timeSecondsTop;if(timeTop.current){window.clearInterval(timeTop.current);clearInterval(timeTop.current);}if(topFocus===null){timeTop.current=setInterval(function(){value+=period;setTimeSecondsTop(value);},period);}else{setTimeSecondsTop(0);}var accumulatorTimeThreshold=dicoin.recordGenerationRules?dicoin.recordGenerationRules.accumulatorTimeThreshold:2000;if(timeSecondsTop>=accumulatorTimeThreshold){window.clearInterval(timeTop.current);clearInterval(timeTop.current);}}},[timeSecondsTop,openCard,focusInput]);useEffect(function(){var botFocus=(focusInput||'').match('bot');if(timeSecondsBot>=0&&openCard){var value=timeSecondsBot;if(timeBot.current){window.clearInterval(timeBot.current);clearInterval(timeBot.current);}if(botFocus===null){timeBot.current=setInterval(function(){value+=period;setTimeSecondsBot(value);},period);}else{setTimeSecondsBot(0);}var accumulatorTimeThreshold=dicoin.recordGenerationRules?dicoin.recordGenerationRules.accumulatorTimeThreshold:2000;if(timeSecondsBot>=accumulatorTimeThreshold){window.clearInterval(timeBot.current);clearInterval(timeBot.current);}}},[timeSecondsBot,openCard,focusInput]);// #endregion\n//  #region btn count passengers\nvar _useState27=useState({entry:0,exit:0}),_useState28=_slicedToArray(_useState27,2),topDoor=_useState28[0],setTopDoor=_useState28[1];var _useState29=useState({entry:0,exit:0}),_useState30=_slicedToArray(_useState29,2),botDoor=_useState30[0],setBotDoor=_useState30[1];function handleAddCountDoorEntry(type,event){window.navigator.vibrate(80);var data=event&&parseInt(event.target.value,10)||0;if(type==='top'){setTimeSecondsTop(0);setTopDoor(_objectSpread(_objectSpread({},topDoor),{},{entry:event?data:topDoor.entry+1}));}else{setTimeSecondsBot(0);setBotDoor(_objectSpread(_objectSpread({},botDoor),{},{entry:event?data:botDoor.entry+1}));}}function handleAddCountDoorExit(type,event){window.navigator.vibrate(80);var data=event&&parseInt(event.target.value,10)||0;if(type==='top'){setTimeSecondsTop(0);setTopDoor(_objectSpread(_objectSpread({},topDoor),{},{exit:event?data:topDoor.exit+1}));}else{setTimeSecondsBot(0);setBotDoor(_objectSpread(_objectSpread({},botDoor),{},{exit:event?data:botDoor.exit+1}));}}//  #endregion\n//  #region dialog statistics\nvar _useState31=useState(false),_useState32=_slicedToArray(_useState31,2),openDialogStatistics=_useState32[0],setOpenDialogStatistics=_useState32[1];function handleOpenDialogStatistics(){setOpenDialogStatistics(true);}function handleCloseDialogStatistics(){setOpenDialogStatistics(false);}//  #endregion\n//  #region dialog statistics\nvar _useState33=useState(false),_useState34=_slicedToArray(_useState33,2),openDialogRecordDetails=_useState34[0],setOpenDialogRecordDetails=_useState34[1];var _useState35=useState(),_useState36=_slicedToArray(_useState35,2),dataDialogDetails=_useState36[0],setDataDialogDetails=_useState36[1];function handleOpenDialogRecordDetails(data){setOpenDialogRecordDetails(true);setDataDialogDetails(data);}function handleCloseDialogRecordDetails(){setOpenDialogRecordDetails(false);}//  #endregion\n//  #region Download\nvar _useState37=useState(false),_useState38=_slicedToArray(_useState37,2),openDialogDownload=_useState38[0],setOpenDialogDownload=_useState38[1];function handleOpenDialogDownload(){setOpenDialogDownload(true);}function handleCloseDialogDownload(){setOpenDialogDownload(false);}//  #endregion\n// #region Engine\n/**\n   * @type [Dicoin,function]\n   */var _useState39=useState(function(){return new Dicoin();}),_useState40=_slicedToArray(_useState39,2),dicoin=_useState40[0],setDicoin=_useState40[1];var _useState41=useState([]),_useState42=_slicedToArray(_useState41,2),events=_useState42[0],setEvents=_useState42[1];var _useState43=useState(false),_useState44=_slicedToArray(_useState43,2),tripReported=_useState44[0],setTripReported=_useState44[1];var _useState45=useState([]),_useState46=_slicedToArray(_useState45,2),records=_useState46[0],setRecords=_useState46[1];var _useState47=useState({}),_useState48=_slicedToArray(_useState47,2),tripTempState=_useState48[0],setTripTempState=_useState48[1];var _useState49=useState({}),_useState50=_slicedToArray(_useState49,2),tripState=_useState50[0],setTripState=_useState50[1];var _useState51=useState(false),_useState52=_slicedToArray(_useState51,2),tripType=_useState52[0],setTripType=_useState52[1];var _useState53=useState(false),_useState54=_slicedToArray(_useState53,2),didDBStart=_useState54[0],setDidDBStart=_useState54[1];var geolocation=useGeolocation({enableHighAccuracy:true,maximumAge:1500,timeout:13000},function(){});var _useState55=useState({top:false,bot:false}),_useState56=_slicedToArray(_useState55,2),stateDoor=_useState56[0],setStateDoor=_useState56[1];var _useState57=useState(false),_useState58=_slicedToArray(_useState57,2),loading=_useState58[0],setLoading=_useState58[1];function handleDialogNewExecution(dataDialogNewExecutionToCreate){localStorage.setItem('infoCreationExecution',JSON.stringify({routeCode:dataDialogNewExecutionToCreate.routeCode,route:dataDialogNewExecutionToCreate.route,plate:dataDialogNewExecutionToCreate.plate,driverLicense:dataDialogNewExecutionToCreate.driverLicense,nitCompany:dataDialogNewExecutionToCreate.nitCompany,onLine:dataDialogNewExecutionToCreate.onLine}));var transmisionConfigData=localStorage.getItem('transmissionConfig')?JSON.parse(localStorage.getItem('transmissionConfig')):null;var recordGenerationRulesData=localStorage.getItem('recordGenerationRules')?JSON.parse(localStorage.getItem('recordGenerationRules')):null;if(!transmisionConfigData||!recordGenerationRulesData){enqueueSnackbar(t('INVALID_PARAMS'),{variant:'error'});}else{var trip=new Trip(dataDialogNewExecutionToCreate.routeCode,dataDialogNewExecutionToCreate.route,dataDialogNewExecutionToCreate.plate,dataDialogNewExecutionToCreate.driverLicense,dataDialogNewExecutionToCreate.nitCompany,dicoin.tripErrorReporter.bind(dicoin));setTripType(dataDialogNewExecutionToCreate.onLine);var transmissionConfig=new TransmissionConfig(dataDialogNewExecutionToCreate.onLine,transmisionConfigData.url,transmisionConfigData.user,transmisionConfigData.password,parseInt(transmisionConfigData.maxRetires,10),parseInt(transmisionConfigData.delayBetweenRetries,10),dicoin.tripErrorReporter.bind(dicoin));var withRouteRules=recordGenerationRulesData.withRoute;var recordGenerationRules=new RecordGenerationRules(parseInt(withRouteRules.distanceThreshold,10),parseInt(withRouteRules.timeThreshold,10)*1000,parseInt(withRouteRules.speedThreshold,10),withRouteRules.useDoorStateAsTrigger,recordGenerationRulesData.accumulatorTimeThreshold,dicoin.tripErrorReporter.bind(dicoin));dicoin.startTrip(trip,transmissionConfig,recordGenerationRules);}}useEffect(function(){window.addEventListener('resize',function(){setAvailableHeight(window.innerHeight-210);});var dataLocal=JSON.parse(localStorage.getItem('infoCreationExecution'));if(dataLocal){setDataDialogNewExecution(_objectSpread(_objectSpread({},dataDialogNewExecution),dataLocal));}dicoin.addListener('TRAVEL',function(event){switch(event.type){case EVENT_TYPES.TRIP_REPORT_GENERATED:var _event$payload=event.payload,reportContent=_event$payload.reportContent,fileName=_event$payload.fileName;setLoading(false);FileSaver.saveAs(reportContent,fileName);break;case EVENT_TYPES.ERROR_REPORTED:enqueueSnackbar(t(event.payload.message),{variant:'error'});break;case EVENT_TYPES.TRIP_REPORTED:enqueueSnackbar('Reportado Correctamente',{variant:'success'});setTripReported(true);break;case EVENT_TYPES.TRIP_STARTED:setTripState(event.payload.state);setTripTempState(event.payload.tempState||{});setOpen(false);setInitialized(true);break;case EVENT_TYPES.TRIP_LOADED:if(event.payload.tripState==='FINALIZED'){setStateRoute(event.payload.reason);setOpenDialogFinalize(false);setInitialized(false);}else{setInitialized(true);}setTripState(event.payload.state||{});setTripTempState(event.payload.tempState||{});break;case EVENT_TYPES.TRIP_STATE_CHANGED:setTripState(event.payload.state||{});setTripTempState(event.payload.tempState||{});break;case EVENT_TYPES.TRIP_STOPPED:setTripState(event.payload.state||{});setTripTempState(event.payload.tempState||{});break;case EVENT_TYPES.RECORD_GENERATED:var newRecordsGenerated=_.cloneDeep(event.payload.records);setRecords(newRecordsGenerated);break;case EVENT_TYPES.RECORD_UPDATED:var newRecordsUpdated=_.cloneDeep(event.payload.records);setRecords(newRecordsUpdated);break;case EVENT_TYPES.NOTE_ADDED:var newRecordsAndNotesGenerated=_.cloneDeep(event.payload.records);setRecords(newRecordsAndNotesGenerated);break;case EVENT_TYPES.TRIP_TYPE_REPORTED:setTripType(event.payload.online);break;case EVENT_TYPES.TRIP_REMOVED:setTripState({});setTripTempState({});setRecords([]);setInitialized(false);setStateRoute(null);break;case EVENT_TYPES.DB_STARTED:setDidDBStart(true);break;default:console.log('UNPROCESSED EVENT',event.type);break;}events.push(event);setEvents(_toConsumableArray(events));});return function(){dicoin.removeListener('TRAVEL');dicoin.stopTrip('ABORTED_BY_USER_SECCION',true);};},[]);useEffect(function(){if(didDBStart){dicoin.recoverPersistedState();}},[didDBStart]);useEffect(function(){console.log(\"GEOLOCATION_ON_USEEFFECT\",geolocation);if(!geolocation.error&&geolocation&&didDBStart){if(initialized){dicoin.reportGeolocationPosition(geolocation);}}},[geolocation.coords,geolocation.error,initialized,didDBStart]);function generateReport(){setLoading(true);dicoin.generateContentReport();}function handleDoor(type){var doorState=_objectSpread(_objectSpread({},stateDoor),{},_defineProperty({},type,!stateDoor[type]));setStateDoor(doorState);}// #endregion\n//  #region dialogNote\nvar _useState59=useState(false),_useState60=_slicedToArray(_useState59,2),openDialogNote=_useState60[0],setOpenDialogNote=_useState60[1];function handleOpenDialogNote(){setOpenDialogNote(true);}function handleCloseDialogNote(){setOpenDialogNote(false);}function handleAddNote(note){setOpenDialogNote(false);dicoin.addNote(note);}//  #endregion\n//  #region stateBtnDoors\nvar _useState61=useState({entry:0,exit:0}),_useState62=_slicedToArray(_useState61,2),stateCountTopDoor=_useState62[0],setStateCountTopDoor=_useState62[1];var _useState63=useState({entry:0,exit:0}),_useState64=_slicedToArray(_useState63,2),stateCountBotDoor=_useState64[0],setStateCountBotDoor=_useState64[1];useEffect(function(){var accumulatorTimeThreshold=dicoin.recordGenerationRules?dicoin.recordGenerationRules.accumulatorTimeThreshold:2000;if(timeSecondsTop>=accumulatorTimeThreshold&&topDoor){var action=function action(){setStateCountTopDoor(_objectSpread(_objectSpread({},stateCountTopDoor),{},{entry:stateCountTopDoor.entry+topDoor.entry,exit:stateCountTopDoor.exit+topDoor.exit}));dicoin.reportPassengerFlow((topDoor||{}).entry||0,(topDoor||{}).exit||0,0,0);setTimeout(function(){setTopDoor({entry:0,exit:0});},500);};applierCallBack({applierSource:'timeSecondsTop',action:action});}},[timeSecondsTop]);useEffect(function(){var accumulatorTimeThreshold=dicoin.recordGenerationRules?dicoin.recordGenerationRules.accumulatorTimeThreshold:2000;if(timeSecondsBot>=accumulatorTimeThreshold&&botDoor){var action=function action(){setStateCountBotDoor(_objectSpread(_objectSpread({},stateCountBotDoor),{},{entry:stateCountBotDoor.entry+botDoor.entry,exit:stateCountBotDoor.exit+botDoor.exit}));dicoin.reportPassengerFlow(0,0,(botDoor||{}).entry||0,(botDoor||{}).exit||0);setTimeout(function(){setBotDoor({entry:0,exit:0});},500);};applierCallBack({applierSource:'timeSecondsBot',action:action});}},[timeSecondsBot]);useEffect(function(){if(initialized){var action=function action(){if(botDoor){setStateCountBotDoor(_objectSpread(_objectSpread({},stateCountBotDoor),{},{entry:stateCountBotDoor.entry+botDoor.entry,exit:stateCountBotDoor.exit+botDoor.exit}));dicoin.reportPassengerFlow(0,0,(botDoor||{}).entry||0,(botDoor||{}).exit||0);setTimeout(function(){setBotDoor({entry:0,exit:0});},500);}if(topDoor){setStateCountTopDoor(_objectSpread(_objectSpread({},stateCountTopDoor),{},{entry:stateCountTopDoor.entry+topDoor.entry,exit:stateCountTopDoor.exit+topDoor.exit}));dicoin.reportPassengerFlow((topDoor||{}).entry||0,(topDoor||{}).exit||0,0,0);setTimeout(function(){setTopDoor({entry:0,exit:0});},500);}setTimeSecondsTop(11);setTimeSecondsBot(11);};applierCallBack({applierSource:'timeSecondsBot',action:action});dicoin.reportDoorsStatus(stateDoor.top,stateDoor.bot);}},[stateDoor]);//  #endregion\n// #region Dialgo Confirm remove\nvar _useState65=useState(false),_useState66=_slicedToArray(_useState65,2),openDialogConfirm=_useState66[0],setOpenDialogConfirm=_useState66[1];function handleOpenDialogConfirm(){setOpenDialogConfirm(true);}function handleCloseDialogConfirm(){setOpenDialogConfirm(false);}function handleComfirmRemoveTrip(){setOpenDialogConfirm(false);dicoin.clearTrip();}// #endregion\n//  #region dialg finalize\nvar _useState67=useState(false),_useState68=_slicedToArray(_useState67,2),openDialogFinalize=_useState68[0],setOpenDialogFinalize=_useState68[1];var _useState69=useState(null),_useState70=_slicedToArray(_useState69,2),stateRoute=_useState70[0],setStateRoute=_useState70[1];function handleOpenDialogFinalize(){if(dicoin.trip.route==='NA'){setStateRoute('NA');setOpenDialogFinalize(false);setInitialized(false);setOpenCard(false);dicoin.stopTrip('NA',true,true);}else{setOpenDialogFinalize(true);}}function handleCloseDialogFinalize(){setOpenDialogFinalize(false);}function hadleStateRoute(state){setStateRoute(state);setOpenDialogFinalize(false);setInitialized(false);setOpenCard(false);dicoin.stopTrip(state,true,true);}//  #endregion\nfunction handleReportTrip(){dicoin.reportTripState();}function getLatLngasString(){var _ref4=((tripTempState||{}).geolocationPosition||{}).coords||{},latitude=_ref4.latitude,longitude=_ref4.longitude;if(latitude==null||longitude==null||latitude===undefined||longitude===undefined){return'---,---';}console.log('=== toFixed getLatLngasString',latitude,longitude,latitude.toFixed,longitude.toFixed);return\"\".concat(latitude.toFixed(5),\",\").concat(longitude.toFixed(5));}function getSpeedAsString(){var _ref5=((tripTempState||{}).geolocationPosition||{}).coords||{},speed=_ref5.speed;if(speed===null||speed===undefined)return'-- km/h';console.log('=== toFixed getSpeedAsString',speed,speed.toFixed);return\"\".concat(speed.toFixed(0),\" km/h\");}function getDopAsString(){var _ref6=((tripTempState||{}).geolocationPosition||{}).coords||{},dop=_ref6.dop;if(dop===null||dop===undefined)return'--';console.log('=== toFixed getDopAsString',dop,dop.toFixed);return\"\".concat(dop.toFixed?dop.toFixed(1):dop);}function getAccuaracyAsString(){var _ref7=((tripTempState||{}).geolocationPosition||{}).coords||{},accuracy=_ref7.accuracy;if(accuracy===null||accuracy===undefined)return'--';console.log('=== toFixed getAccuaracyAsString',accuracy,accuracy.toFixed);return\"\".concat(accuracy.toFixed(0));}function openMaps(){if(!(((tripTempState||{}).geolocationPosition||{}).coords||{}).latitude)return;var _tripTempState$geoloc=tripTempState.geolocationPosition.coords,latitude=_tripTempState$geoloc.latitude,longitude=_tripTempState$geoloc.longitude;window.open(\"https://maps.google.com?q=\".concat(latitude,\",\").concat(longitude));}return/*#__PURE__*/_jsx(TravelContext.Provider,{value:{hadleOpenBtnDrag:hadleOpenBtnDrag,hadleCloseBtnDrag:hadleCloseBtnDrag,setDisplayBtnDisabled:setDisplayBtnDisabled,handleAddCountDoorEntry:handleAddCountDoorEntry,handleAddCountDoorExit:handleAddCountDoorExit,handleOpenDialogRecordDetails:handleOpenDialogRecordDetails,handleDoor:handleDoor,setProgressLoading:setProgressLoading,setAvailableHeight:setAvailableHeight,openCard:openCard,displayBtnDisabled:displayBtnDisabled,keyboardDetected:keyboardDetected,cards:cards,topDoor:topDoor,botDoor:botDoor,stateCountTopDoor:stateCountTopDoor,stateCountBotDoor:stateCountBotDoor,timeSecondsTop:timeSecondsTop,timeSecondsBot:timeSecondsBot,stateDoor:stateDoor,initialized:initialized,stateRoute:stateRoute,progressLoading:progressLoading,records:records,tripTempState:tripTempState,tripState:tripState,dicoin:dicoin,availableHeight:availableHeight,rowHeight:rowHeight},children:/*#__PURE__*/_jsx(\"div\",{children:orientation==='portrait'&&isMobile||orientation==='landscape'&&!isMobile?/*#__PURE__*/_jsx(Root,{header:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex flex-wrap place-content-start\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-full py-10 px-16 flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[configFuse.navbar.display&&configFuse.navbar.position==='left'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Hidden,{lgDown:true,children:[(configFuse.navbar.style==='style-3'||configFuse.navbar.style==='style-3-dense')&&/*#__PURE__*/_jsx(NavbarToggleButton,{className:\"w-40 h-40 p-0 mx-0\"}),configFuse.navbar.style==='style-1'&&!navbar.open&&/*#__PURE__*/_jsx(NavbarToggleButton,{className:\"w-40 h-40 p-0 mx-0\"})]}),/*#__PURE__*/_jsx(Hidden,{lgUp:true,children:/*#__PURE__*/_jsx(NavbarToggleButton,{className:\"w-40 h-40 p-0 mx-0 sm:mx-8\"})})]}),/*#__PURE__*/_jsxs(_Fragment,{children:[initialized&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"\".concat(classes.btnHeaderWhite,\" mr-5\"),onClick:function onClick(){handleOpenDialogNote();},children:/*#__PURE__*/_jsx(Icon,{children:\"note_add\"})}),(initialized&&stateRoute===null||!initialized&&stateRoute!==null)&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"\".concat(classes.btnHeaderWhite,\" mr-5\"),onClick:function onClick(){handleOpenDialogStatistics();},children:/*#__PURE__*/_jsx(Icon,{children:\"show_chart\"})}),initialized&&/*#__PURE__*/_jsx(Button,{id:\"myBtnHeaderCards213\",variant:\"contained\",className:\"\".concat(classes.btnHeaderWhite,\" \").concat(displayBtnDisabled&&classes.noHover),disabled:progressLoading||!displayBtnDisabled&&openCard,onClick:function onClick(evt){evt.stopPropagation();hadleOpenBtnDrag();},children:progressLoading?/*#__PURE__*/_jsx(CircularProgress,{size:25}):/*#__PURE__*/_jsx(Icon,{children:\"adjust\"})}),!initialized&&stateRoute!==null&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"\".concat(classes.btnHeader,\" mr-5\"),color:\"error\",onClick:function onClick(){handleOpenDialogConfirm();},children:/*#__PURE__*/_jsx(Icon,{children:\"delete_forever\"})}),!initialized&&stateRoute!==null&&/*#__PURE__*/_jsx(Button,{variant:\"contained\",className:\"\".concat(classes.btnHeader,\" mr-5\"),color:\"success\",disabled:tripReported||tripType,onClick:function onClick(){handleReportTrip();},children:/*#__PURE__*/_jsx(Icon,{children:\"publish\"})})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[!initialized&&stateRoute===null&&/*#__PURE__*/_jsxs(Button,{variant:\"contained\",color:\"success\",onClick:function onClick(){handleClickOpen();},children:[/*#__PURE__*/_jsx(Icon,{children:\"flag\"}),t('TRAVEL_HEADER_START')]}),initialized&&stateRoute===null&&/*#__PURE__*/_jsxs(Button,{variant:\"contained\",color:\"error\",onClick:function onClick(){handleOpenDialogFinalize();},children:[t('TRAVEL_HEADER_FINALIZE'),/*#__PURE__*/_jsx(Icon,{children:\"flag\"})]}),!initialized&&stateRoute!==null&&/*#__PURE__*/_jsxs(Button,{variant:\"contained\",className:\"\".concat(classes.btnSilver),onClick:function onClick(evt){evt.stopPropagation();generateReport();},children:[/*#__PURE__*/_jsx(Icon,{children:\"assignment_returned\"}),t('TRAVEL_HEADER_DOWNLOAD')]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"w-full flex items-center pt-5 pb-10 px-16\",children:[/*#__PURE__*/_jsxs(Typography,{className:\"text-xs mr-10\",onClick:openMaps,children:[/*#__PURE__*/_jsx(Icon,{className:\"\".concat(classes.TransformRotate,\" text-sm mr-5\"),children:\"send\"}),getLatLngasString()]}),/*#__PURE__*/_jsxs(Typography,{className:\"text-xs mr-10\",children:[/*#__PURE__*/_jsx(Icon,{className:\"text-sm mr-5\",children:\"av_timer\"}),getSpeedAsString()]}),/*#__PURE__*/_jsxs(Typography,{className:\"text-xs mr-10\",children:[/*#__PURE__*/_jsx(Icon,{className:\"text-sm mr-5\",children:\"satellite_alt\"}),getDopAsString()]}),/*#__PURE__*/_jsxs(Typography,{className:\"text-xs mr-10\",children:[/*#__PURE__*/_jsx(Icon,{className:\"text-sm mr-5\",children:\"radio_button_checked\"}),getAccuaracyAsString()]}),/*#__PURE__*/_jsxs(Typography,{className:\"text-xs\",children:[/*#__PURE__*/_jsx(Icon,{className:\"text-sm mr-5\",children:\"sync_alt\"}),dataDialogNewExecution.onLine?\"\".concat(records.filter(function(r){return r.state==='SENT';}).length||'0',\"/\"):'',' ',records.filter(function(r){return r.type==='RECORD';}).length||'0']})]})]}),content:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(classes.contenTable,\" p-10\"),children:[/*#__PURE__*/_jsx(TableExecution,{accumulatorTimeThreshold:dicoin&&dicoin.recordGenerationRules?dicoin.recordGenerationRules.accumulatorTimeThreshold:2000}),open&&/*#__PURE__*/_jsx(DialogCreateExecution,{open:open,handleClose:handleClose,dataDialogNewExecution:dataDialogNewExecution,setDataDialogNewExecution:setDataDialogNewExecution,handleDialogNewExecution:handleDialogNewExecution}),openDialogNote&&/*#__PURE__*/_jsx(DialogAddNote,{open:openDialogNote,handleClose:handleCloseDialogNote,handleAddNote:handleAddNote}),openDialogFinalize&&/*#__PURE__*/_jsx(DialogFinalize,{open:openDialogFinalize,handleClose:handleCloseDialogFinalize,hadleStateRoute:hadleStateRoute}),openDialogStatistics&&/*#__PURE__*/_jsx(DialogStatistics,{open:openDialogStatistics,handleClose:handleCloseDialogStatistics}),openDialogRecordDetails&&/*#__PURE__*/_jsx(DialogRecordDetail,{open:openDialogRecordDetails,handleClose:handleCloseDialogRecordDetails,record:dataDialogDetails}),openDialogDownload&&/*#__PURE__*/_jsx(DialogDownload,{open:openDialogDownload,handleClose:handleCloseDialogDownload}),openDialogConfirm&&/*#__PURE__*/_jsx(DialogConfirm,{open:openDialogConfirm,handleClose:handleCloseDialogConfirm,handleAction:handleComfirmRemoveTrip})]})}):/*#__PURE__*/_jsx(Root,{header:/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex flex-wrap place-content-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-full py-10 px-16 flex items-center justify-center h-screen\",children:/*#__PURE__*/_jsx(Typography,{className:\"text-center w-full text-sm\",children:/*#__PURE__*/_jsx(\"b\",{children:t('TRAVEL_APPLICATION_ORIENTATION_ERROR_MESSAGE')})})})})})})});}export default TravelsPage;","map":null,"metadata":{},"sourceType":"module"}