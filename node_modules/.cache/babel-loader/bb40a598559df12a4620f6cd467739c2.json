{"ast":null,"code":"import _slicedToArray from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect,useContext}from'react';import moment from'moment';import{useTranslation}from'react-i18next';import{Button,Dialog,DialogActions,DialogContent,DialogTitle,Typography,Icon}from'@mui/material';import{makeStyles}from'@mui/styles';import TravelContext from'../travel-context/TravelContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles({});export default function DialogStatistics(props){var open=props.open,handleClose=props.handleClose;var _useTranslation=useTranslation('travelsPage'),t=_useTranslation.t;var classes=useStyles();var _useContext=useContext(TravelContext),records=_useContext.records,tripState=_useContext.tripState,dicoin=_useContext.dicoin;var _useState=useState({totalRecord:0,totalLatency:0,pending:0,retrying:0,sent:0,error:0}),_useState2=_slicedToArray(_useState,2),recordSummary=_useState2[0],setRecordSummary=_useState2[1];useEffect(function(){if(records){var recordsSummary=records.reduce(function(acc,record){if(record.type==='RECORD'){acc.totalLatency+=dicoin.getRecordAttemptsLatencyAverage(record);acc.totalRecord+=1;if(record.state==='PERSISTED')acc.pending+=1;if(record.state==='SENDING')acc.retrying+=1;if(record.state==='SENT')acc.sent+=1;if(record.state==='ERROR')acc.error+=1;}return acc;},{totalRecord:0,totalLatency:0,pending:0,retrying:0,sent:0,error:0});console.log(recordsSummary);setRecordSummary(recordsSummary);}},[records]);var _useState3=useState({frontDoorInput:0,backDoorInput:0,frontDoorOutput:0,backDoorOutput:0,timestamp:0,endTimestamp:0,taveledTime:0}),_useState4=_slicedToArray(_useState3,2),tripSummary=_useState4[0],setTripSummary=_useState4[1];useEffect(function(){if(tripState){console.log(tripState);var summary={frontDoorInput:tripState.frontDoorInput,backDoorInput:tripState.backDoorInput,frontDoorOutput:tripState.frontDoorOutput,backDoorOutput:tripState.backDoorOutput,timestamp:tripState.timestamp,endTimestamp:tripState.endTimestamp?tripState.endTimestamp:0,taveledTime:tripState.endTimestamp?tripState.endTimestamp-tripState.timestamp:Date.now()-tripState.timestamp};setTripSummary(summary);}},[tripState]);function msToTime(duration){var seconds=Math.floor(duration/1000%60);var minutes=Math.floor(duration/(1000*60)%60);var hours=Math.floor(duration/(1000*60*60)%24);return\"\".concat(hours<9?\"0\".concat(hours):hours,\":\").concat(minutes<9?\"0\".concat(minutes):minutes,\":\").concat(seconds<9?\"0\".concat(seconds):seconds);}return/*#__PURE__*/_jsxs(Dialog,{open:open,onClose:handleClose,\"aria-labelledby\":\"alert-dialog-title\",\"aria-describedby\":\"alert-dialog-description\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"alert-dialog-title\",children:t('TRAVEL_DIALOG_STATISTICS_TITLE')}),/*#__PURE__*/_jsxs(DialogContent,{dividers:true,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start\",children:[/*#__PURE__*/_jsx(Icon,{className:\"mr-10\",children:\"sync_alt\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Typography,{children:[recordSummary.sent<9?\"0\".concat(recordSummary.sent):recordSummary.sent,\"/\",recordSummary.totalRecord<9?\"0\".concat(recordSummary.totalRecord):recordSummary.totalRecord,\",\",t('TRAVEL_DIALOG_STATISTICS_PENDING_EVENTS'),\": \",/*#__PURE__*/_jsx(\"b\",{children:recordSummary.pending}),\",\",t('TRAVEL_DIALOG_STATISTICS_RETRANSMISSION_ATTEMPT'),\":\",' ',/*#__PURE__*/_jsx(\"b\",{children:recordSummary.retrying}),\",\",t('TRAVEL_DIALOG_STATISTICS_TRANSMISSION_ERRORS'),\":\",/*#__PURE__*/_jsx(\"b\",{children:recordSummary.error})]}),/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_TRANSMISSION_LATENCY'),\":\",' ',/*#__PURE__*/_jsx(\"b\",{children:recordSummary.totalLatency/recordSummary.totalRecord>0?\"\".concat(parseInt(recordSummary.totalLatency/recordSummary.totalRecord,10),\"milisegundos\"):'--'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start mt-10\",children:[/*#__PURE__*/_jsx(Icon,{className:\"mr-10\",children:\"people_alt\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_INCOME'),\":\",' ',/*#__PURE__*/_jsxs(\"b\",{children:[tripSummary.frontDoorInput+tripSummary.backDoorInput,\", \"]}),t('TRAVEL_DIALOG_STATISTICS_DEPARTURES'),\":\",' ',/*#__PURE__*/_jsx(\"b\",{children:tripSummary.frontDoorOutput+tripSummary.backDoorOutput})]}),/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_PASSENGERS_IN_BUS'),\":\",' ',/*#__PURE__*/_jsx(\"b\",{children:tripSummary.frontDoorInput+tripSummary.backDoorInput-(tripSummary.frontDoorOutput+tripSummary.backDoorOutput)})]}),/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_FRONT_DOOR'),\":\",' ',/*#__PURE__*/_jsxs(\"b\",{children:[\"+\",tripSummary.frontDoorInput,\" -\",tripSummary.frontDoorOutput]})]}),/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_BACK_DOOR'),\":\",' ',/*#__PURE__*/_jsxs(\"b\",{children:[\"+\",tripSummary.backDoorInput,\" -\",tripSummary.backDoorOutput]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start mt-10\",children:[/*#__PURE__*/_jsx(Icon,{className:\"mr-10\",children:\"access_time\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_LAPSE_OF_TIME'),\":\",' ',/*#__PURE__*/_jsxs(\"b\",{children:[\" \",msToTime(tripSummary.taveledTime)]})]}),/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_START'),\":\",' ',/*#__PURE__*/_jsxs(\"b\",{children:[\" \",moment(tripSummary.timestamp).format('DD/MM/YYYY HH:mm:ss')]})]}),/*#__PURE__*/_jsxs(Typography,{children:[t('TRAVEL_DIALOG_STATISTICS_END'),\":\",' ',/*#__PURE__*/_jsx(\"b\",{children:tripSummary.endTimestamp?moment(tripSummary.endTimestamp).format('DD/MM/YYYY HH:mm:ss'):'--/--/--- --:--:--'})]})]})]})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:handleClose,variant:\"contained\",color:\"error\",children:t('TRAVEL_DIALOG_STATISTICS_CLOSE')})})]});}","map":null,"metadata":{},"sourceType":"module"}