{"ast":null,"code":"import _slicedToArray from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _objectWithoutProperties from\"/Users/sebastianmolano/NebulaE/Projects/GTPC/dicon-audit-pwa/frontend/dicon-audit-pwa/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";var _excluded=[\"children\",\"value\",\"index\"];import{useState,useEffect}from'react';import FusePageSimple from'@fuse/core/FusePageSimple';import{useTranslation}from'react-i18next';import{useSelector}from'react-redux';import{useSnackbar}from'notistack';import{styled}from'@mui/material/styles';import{Hidden,Button,Tabs,Tab,Box}from'@mui/material';import{makeStyles}from'@mui/styles';import _ from'@lodash';import WsRest from'./tabs/WsRest';import Travels from'./tabs/Travels';import NavbarToggleButton from'../../fuse-layouts/shared-components/NavbarToggleButton';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Root=styled(FusePageSimple)({'& .FusePageSimple-header':{height:'auto',minHeight:'auto'},'& .FusePageSimple-toolbar':{},'& .FusePageSimple-content':{},'& .FusePageSimple-sidebarHeader':{},'& .FusePageSimple-sidebarContent':{}});var useStyles=makeStyles({});var height=160;function TabPanel(props){var children=props.children,value=props.value,index=props.index,other=_objectWithoutProperties(props,_excluded);return/*#__PURE__*/_jsx(\"div\",_objectSpread(_objectSpread({role:\"tabpanel\",hidden:value!==index,id:\"simple-tabpanel-\".concat(index),\"aria-labelledby\":\"simple-tab-\".concat(index)},other),{},{children:value===index&&/*#__PURE__*/_jsx(Box,{className:\"p-10\",children:/*#__PURE__*/_jsx(\"div\",{children:children})})}));}function SettingPage(props){var _useTranslation=useTranslation('settingPage'),t=_useTranslation.t;var configFuse=useSelector(function(_ref){var fuse=_ref.fuse;return fuse.settings.current.layout.config;});var navbar=useSelector(function(_ref2){var fuse=_ref2.fuse;return fuse.navbar;});var _useState=useState(0),_useState2=_slicedToArray(_useState,2),tabValue=_useState2[0],setTabValue=_useState2[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;// WSREST\nvar _useState3=useState('https://gtpc.metropol.gov.co/gtpc/servicesRest/archivos/procesarRecorrido'),_useState4=_slicedToArray(_useState3,2),endPoint=_useState4[0],setEndPoint=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),password=_useState8[0],setPassword=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),resultTestConnection=_useState10[0],setResultTestConnection=_useState10[1];var _useState11=useState(3),_useState12=_slicedToArray(_useState11,2),numberOfAttemps=_useState12[0],setNumberOfAttemps=_useState12[1];var _useState13=useState(150),_useState14=_slicedToArray(_useState13,2),waitTimeBetweenRetries=_useState14[0],setWaitTimeBetweenRetries=_useState14[1];var _useState15=useState(5000),_useState16=_slicedToArray(_useState15,2),timeout=_useState16[0],seTimeout=_useState16[1];// TRAVEL\nvar _useState17=useState(3000),_useState18=_slicedToArray(_useState17,2),countdown=_useState18[0],setCountdown=_useState18[1];// TRAVEL: registros con ruta\nvar _useState19=useState(240),_useState20=_slicedToArray(_useState19,2),advanceVehicle=_useState20[0],setAdvanceVehicle=_useState20[1];var _useState21=useState(30),_useState22=_slicedToArray(_useState21,2),elapse=_useState22[0],setElapse=_useState22[1];var _useState23=useState(0),_useState24=_slicedToArray(_useState23,2),speed=_useState24[0],setSpeed=_useState24[1];var _useState25=useState(true),_useState26=_slicedToArray(_useState25,2),useDoorStateAsTrigger=_useState26[0],setUseDoorStateAsTrigger=_useState26[1];// TRAVEL: registros sin ruta\nvar _useState27=useState(100),_useState28=_slicedToArray(_useState27,2),withoutAdvanceVehicle=_useState28[0],setWithoutAdvanceVehicle=_useState28[1];var _useState29=useState(1800),_useState30=_slicedToArray(_useState29,2),withoutElapse=_useState30[0],setWithoutElapse=_useState30[1];var _useState31=useState(0),_useState32=_slicedToArray(_useState31,2),withoutSpeed=_useState32[0],setWithoutSpeed=_useState32[1];var _useState33=useState(true),_useState34=_slicedToArray(_useState33,2),withoutUseDoorStateAsTrigger=_useState34[0],setWithoutUseDoorStateAsTrigger=_useState34[1];var dataTransmissionConfigLocalStorage=localStorage.getItem('transmissionConfig');var dataRecordGenerationRules=localStorage.getItem('recordGenerationRules');function handleChangeTab(event,tabValueToSet){setTabValue(tabValueToSet);}function validateUrl(url){return typeof url==='string'&&url.length>=0&&/^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i.test(url)?null:t('INVALID_URL');}function validateString(value,minLen,maxLen){return typeof value==='string'&&value.length>=minLen&&value.length<=maxLen?null:\"Debe contener entre \".concat(minLen,\" y \").concat(maxLen,\" caracteres\");}function validateNumber(num,minVal,maxVal){return typeof num==='number'&&num>=minVal&&num<=maxVal?null:\"Debe tener un valor entre \".concat(minVal,\" y \").concat(maxVal);}var valueFocusCleaner=function valueFocusCleaner(value){return value.trim();};var buildTransmissionConfig=function buildTransmissionConfig(){return{user:user,password:password,url:endPoint,timeout:timeout,maxRetires:numberOfAttemps,delayBetweenRetries:waitTimeBetweenRetries};};var buildRecordGenerationRules=function buildRecordGenerationRules(){return{accumulatorTimeThreshold:countdown,withRoute:{distanceThreshold:advanceVehicle,timeThreshold:elapse,speedThreshold:speed,useDoorStateAsTrigger:useDoorStateAsTrigger},withoutRoute:{distanceThreshold:withoutAdvanceVehicle,timeThreshold:withoutElapse,speedThreshold:withoutSpeed,useDoorStateAsTrigger:withoutUseDoorStateAsTrigger}};};function canBeSubmitted(){var canSubmit=!validateString(password,0,200)&&!validateString(user,0,200)&&!validateUrl(endPoint)&&!validateNumber(timeout,0,600000)&&!validateNumber(numberOfAttemps,0,100)&&!validateNumber(waitTimeBetweenRetries,0,60000)&&!validateNumber(advanceVehicle,0,10000)&&!validateNumber(elapse,0,86400000)>=0&&!validateNumber(speed,0,500)&&!validateNumber(withoutAdvanceVehicle,0,10000)&&!validateNumber(withoutSpeed,0,500)&&!validateNumber(countdown,0,60000)&&!validateNumber(withoutElapse,0,86400000);var isTransmisionConfigDifferent=!_.isEqual(buildTransmissionConfig(),JSON.parse(localStorage.getItem('transmissionConfig')||'{}'));var isRecordGenerationRulesDifferent=!_.isEqual(buildRecordGenerationRules(),JSON.parse(localStorage.getItem('recordGenerationRules')||'{}'));return canSubmit&&(isTransmisionConfigDifferent||isRecordGenerationRulesDifferent);}function handleSave(){localStorage.setItem('transmissionConfig',JSON.stringify(buildTransmissionConfig()));localStorage.setItem('recordGenerationRules',JSON.stringify(buildRecordGenerationRules()));enqueueSnackbar(t('Se guardo la configuraci√≥n'),{variant:'success'});}useEffect(function(){console.log('dataRecordGenerationRules',JSON.parse(dataRecordGenerationRules));if(dataTransmissionConfigLocalStorage){var data=JSON.parse(dataTransmissionConfigLocalStorage);setEndPoint(data.url);setNumberOfAttemps(data.maxRetires);setUser(data.user);setPassword(data.password);setWaitTimeBetweenRetries(data.delayBetweenRetries);seTimeout(data.timeout);}if(dataRecordGenerationRules){var _data=JSON.parse(dataRecordGenerationRules);setCountdown(_data.accumulatorTimeThreshold);setAdvanceVehicle(_data.withRoute.distanceThreshold);setElapse(_data.withRoute.timeThreshold);setSpeed(_data.withRoute.speedThreshold);setUseDoorStateAsTrigger(_data.withRoute.useDoorStateAsTrigger);setWithoutAdvanceVehicle(_data.withoutRoute.distanceThreshold);setWithoutElapse(_data.withoutRoute.timeThreshold);setWithoutSpeed(_data.withoutRoute.speedThreshold);setWithoutUseDoorStateAsTrigger(_data.withoutRoute.useDoorStateAsTrigger);}},[dataTransmissionConfigLocalStorage,dataRecordGenerationRules]);var childrenProps={endPoint:endPoint,setEndPoint:setEndPoint,user:user,setUser:setUser,password:password,setPassword:setPassword,resultTestConnection:resultTestConnection,setResultTestConnection:setResultTestConnection,numberOfAttemps:numberOfAttemps,setNumberOfAttemps:setNumberOfAttemps,waitTimeBetweenRetries:waitTimeBetweenRetries,setWaitTimeBetweenRetries:setWaitTimeBetweenRetries,timeout:timeout,seTimeout:seTimeout,valueFocusCleaner:valueFocusCleaner,countdown:countdown,setCountdown:setCountdown,advanceVehicle:advanceVehicle,setAdvanceVehicle:setAdvanceVehicle,elapse:elapse,setElapse:setElapse,speed:speed,setSpeed:setSpeed,withoutAdvanceVehicle:withoutAdvanceVehicle,setWithoutAdvanceVehicle:setWithoutAdvanceVehicle,withoutElapse:withoutElapse,setWithoutElapse:setWithoutElapse,withoutSpeed:withoutSpeed,setWithoutSpeed:setWithoutSpeed,useDoorStateAsTrigger:useDoorStateAsTrigger,setUseDoorStateAsTrigger:setUseDoorStateAsTrigger,withoutUseDoorStateAsTrigger:withoutUseDoorStateAsTrigger,setWithoutUseDoorStateAsTrigger:setWithoutUseDoorStateAsTrigger,validateUrl:validateUrl,validateString:validateString,validateNumber:validateNumber};return/*#__PURE__*/_jsx(Root,{header:/*#__PURE__*/_jsx(\"div\",{className:\"w-full flex flex-wrap place-content-start\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-full py-10 px-16 flex items-start justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{children:configFuse.navbar.display&&configFuse.navbar.position==='left'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Hidden,{lgDown:true,children:[(configFuse.navbar.style==='style-3'||configFuse.navbar.style==='style-3-dense')&&/*#__PURE__*/_jsx(NavbarToggleButton,{className:\"w-40 h-40 p-0 mx-0\"}),configFuse.navbar.style==='style-1'&&!navbar.open&&/*#__PURE__*/_jsx(NavbarToggleButton,{className:\"w-40 h-40 p-0 mx-0\"})]}),/*#__PURE__*/_jsx(Hidden,{lgUp:true,children:/*#__PURE__*/_jsx(NavbarToggleButton,{className:\"w-40 h-40 p-0 mx-0 sm:mx-8\"})})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"success\",disabled:!canBeSubmitted(),onClick:handleSave,children:t('SAVE')})})]})}),content:/*#__PURE__*/_jsxs(Box,{sx:{width:'100%'},children:[/*#__PURE__*/_jsx(Box,{sx:{borderBottom:1,borderColor:'divider'},children:/*#__PURE__*/_jsxs(Tabs,{variant:\"scrollable\",value:tabValue,onChange:handleChangeTab,\"aria-label\":\"basic tabs example\",children:[/*#__PURE__*/_jsx(Tab,{label:\"WS REST\",id:\"simple-tab-\".concat(0),\"aria-controls\":\"simple-tabpanel-\".concat(0)}),/*#__PURE__*/_jsx(Tab,{label:\"Viaje\",id:\"simple-tab-\".concat(1),\"aria-controls\":\"simple-tabpanel-\".concat(1)})]})}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:0,children:/*#__PURE__*/_jsx(WsRest,_objectSpread({},childrenProps))}),/*#__PURE__*/_jsx(TabPanel,{value:tabValue,index:1,children:/*#__PURE__*/_jsx(Travels,_objectSpread({},childrenProps))})]})});}export default SettingPage;","map":null,"metadata":{},"sourceType":"module"}